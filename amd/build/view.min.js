/**
 * AMD code for the frequently used comments chooser for the marking guide grading form.
 *
 * @module     mod_verbalfeedback/view
 * @class      view
 * @copyright  2020 Kevin Tippenhauer <kevin.tippenhauer@bfh.ch>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_verbalfeedback/view",["jquery","core/templates","core/notification","core/ajax","core/str","core/modal_save_cancel","core/modal_events"],(function($,Templates,notification,ajax,Str,Modal,ModalEvents){var verbalfeedbackid,ACTIONS_DECLINE_FEEDBACK='[data-action="decline-feedback"]',ACTIONS_UNDO_DECLINE='[data-action="undo-decline"]';function refreshParticipantsList(){var promises=ajax.call([{methodname:"mod_verbalfeedback_data_for_participant_list",args:{verbalfeedbackid:verbalfeedbackid}}]);$.when(promises[0]).then((function(response){return Templates.render("mod_verbalfeedback/list_participants",response)})).done((function(compiledSource,js){$('[data-region="participantlist"]').replaceWith(compiledSource),Templates.runTemplateJS(js)})).fail(notification.exception)}var view=function(id){verbalfeedbackid=id,this.registerEvents()};return view.prototype.registerEvents=function(){$(ACTIONS_DECLINE_FEEDBACK).click((function(e){e.preventDefault();var context={statusid:$(this).data("statusid"),name:$(this).data("name")},declineTemplatePromise=Templates.render("mod_verbalfeedback/decline_feedback",context),titlePromise=Str.get_string("declinefeedback","mod_verbalfeedback");$.when(titlePromise).then((function(title){return Modal.create({title:title,body:declineTemplatePromise,large:!0})})).done((function(modal){modal.show(),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.getRoot().on(ModalEvents.save,(function(){var data={statusid:$("#decline-statusid").val(),declinereason:$("#decline-reason").val().trim()};ajax.call([{methodname:"mod_verbalfeedback_decline_feedback",args:data}])[0].done((function(){refreshParticipantsList()})).fail(notification.exception)}))})).fail(notification.exception)})),$(ACTIONS_UNDO_DECLINE).click((function(e){e.preventDefault();var data={statusid:$(this).data("statusid")};ajax.call([{methodname:"mod_verbalfeedback_undo_decline",args:data}])[0].done((function(){refreshParticipantsList()})).fail(notification.exception)}))},view}));

//# sourceMappingURL=view.min.js.map